---
Создание: 21.06.2024 12:54
Изменение: 21.06.2024 12:54
tags:
  - базы_данных
  - индексы
---

***

Индекс - структура данных, ускоряющая поиск данных по определенному столбцу в базе данных. Индекс формируется из значений одного или нескольких столбцов таблицы. Структурой индекса является сбалансированное дерево

Существует два типа индексов: _кластерные и некластерные_

> Примечание: кластеризированный индекс можно создавать не вручную. Например, при создании первичного ключа автоматически будет создан кластерный индекс

### **Кластерный индекс**

Таблицу с кластерным индексом нельзя назвать «таблицей». Таблица без него называется кучей, а ее данные размещаются на диске в произвольном порядке, выстраиваясь построчно. Если в таблице есть кластерный индекс, то данные в ней сортируются, а структура хранения таблицы на диске преобразуется из аккуратно организованной структуры, в структуру сбалансированного дерева, в котором _реальные строки данных хранятся в листьях индекса_. Другими словами, вся таблица становится индексом

В базе данных существует только один кластеризованный индекс на таблицу, так как функция первичного ключа заключается в преобразовании формата данных «таблицы» в формат «индекса (сбалансированного дерева)»

![[17_06.gif]]

### Нек**ластерный индекс**

_Листья некластеризованного индекса содержат только те столбцы (ключевые), по которым определен данный индекс, а также содержит указатель на строки с реальными данными в таблице._

Некластеризованные индексы не могут быть отсортированы в отличие от кластеризованных, однако вы можете создать более одного некластеризованного индекса на таблицу

Некластеризованные индексы имеют структуру, отдельную от строк данных. То есть он хранится отдельно от таблицы, не меняя ее структуру

Если вы добавите индексы к нескольким полям в таблице, появятся несколько независимых структур индексов, и каждый индекс (некластеризованный индекс) не будет связан друг с другом

Указатель из строки индекса в некластеризованном индексе, который указывает на строку данных, называется указателем строки. Структура указателя на данные зависит от способа хранения данных: кластеризованная таблица или куча. Если указатель ссылается на кластеризованную таблицу, то он ведет к кластеризованному индексу, используя который можно найти реальные данные. Если указатель ссылается на кучу, то он ведет к конкретному идентификатору строки с данными.

![[Untitled 2.png|Untitled 2.png]]

Некластеризованный индекс по таблице, не имеющей кластеризованного индекса

![[Untitled 1.png]]

Некластеризованный индекс по таблице, имеющей кластеризованный индекс

Когда вы формируете запрос на индексированный столбец, подсистема запросов начинает идти сверху от корневого узла и постепенно двигается вниз через промежуточные узлы, при этом каждый слой промежуточного уровня содержит более детальную информацию о данных. Подсистема запросов продолжает двигаться по узлам индекса до тех пор, пока не достигнет нижнего уровня с листьями индекса. Но если отсутствуют доступные индексы, оптимизатор запросов должен использовать просмотр таблицы

***

# Источники
1. [Индекс (базы данных) — Википедия](https://ru.wikipedia.org/wiki/%D0%98%D0%BD%D0%B4%D0%B5%D0%BA%D1%81_(%D0%B1%D0%B0%D0%B7%D1%8B_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85)#%D0%9F%D0%BE%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D1%8C_%D1%81%D1%82%D0%BE%D0%BB%D0%B1%D1%86%D0%BE%D0%B2_%D0%B2_%D1%81%D0%BE%D1%81%D1%82%D0%B0%D0%B2%D0%BD%D0%BE%D0%BC_%D0%B8%D0%BD%D0%B4%D0%B5%D0%BA%D1%81%D0%B5)
2. [https://docs.microsoft.com/ru-ru/sql/relational-databases/indexes/clustered-and-nonclustered-indexes-described?view=sql-server-ver16](https://docs.microsoft.com/ru-ru/sql/relational-databases/indexes/clustered-and-nonclustered-indexes-described?view=sql-server-ver16)
3. [14 вопросов об индексах в SQL Server, которые вы стеснялись задать / Хабр](https://habr.com/ru/post/247373/)
4. [Кластерный индекс и некластерный индекс - Русские Блоги](https://russianblogs.com/article/29261361717/)
5. [18) Кластерный против некластеризованного индекса - CoderLessons.com](https://coderlessons.com/tutorials/bazy-dannykh/osnovy-subd/18-klasternyi-protiv-neklasterizovannogo-indeksa#2)
6. [НОУ ИНТУИТ | SQL Server 2000. Лекция 17: Создание и использование индексов](https://intuit.ru/studies/professional_skill_improvements/1240/courses/68/lecture/2016?page=3)
7. [sql - How does database indexing work? - Stack Overflow](https://stackoverflow.com/questions/1108/how-does-database-indexing-work)
8. [Индексы в PostgreSQL](https://tproger.ru/articles/indeksy-v-postgresql/#:~:text=%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%D0%B5%20%D0%B1%D0%B8%D0%BD%D0%B0%D1%80%D0%BD%D0%BE%D0%B3%D0%BE%20%D0%BF%D0%BE%D0%B8%D1%81%D0%BA%D0%B0)
9. [Transact-SQL | Индексы](https://professorweb.ru/my/sql-server/2012/level3/3_5.php)
